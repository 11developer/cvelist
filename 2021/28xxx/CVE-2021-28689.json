{
   "CVE_data_meta" : {
      "ASSIGNER" : "security@xenproject.org",
      "ID" : "CVE-2021-28689"
   },
   "affects" : {
      "vendor" : {
         "vendor_data" : [
            {
               "product" : {
                  "product_data" : [
                     {
                        "product_name" : "Xen",
                        "version" : {
                           "version_data" : [
                              {
                                 "version_affected" : "?<",
                                 "version_value" : "4.12"
                              },
                              {
                                 "version_affected" : ">=",
                                 "version_value" : null
                              },
                              {
                                 "version_affected" : "!>",
                                 "version_value" : null
                              }
                           ]
                        }
                     }
                  ]
               },
               "vendor_name" : "Xen"
            }
         ]
      }
   },
   "configuration" : {
      "configuration_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Systems running all versions of Xen are affected.\n\nOnly x86 systems are vulnerable, and only CPUs which are potentially\nvulnerable to Spectre v2.  Consult your hardware manufacturer.\n\nThe vulnerability can only be exploited by 32-bit PV guests which are not\nrun in PV-Shim."
               }
            ]
         }
      }
   },
   "credit" : {
      "credit_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "This issue was discovered by Jann Horn of Google Project Zero."
               }
            ]
         }
      }
   },
   "data_format" : "MITRE",
   "data_type" : "CVE",
   "data_version" : "4.0",
   "description" : {
      "description_data" : [
         {
            "lang" : "eng",
            "value" : "32-bit x86 PV guest kernels run in ring 1.  At the time when Xen was\ndeveloped, this area of the i386 architecture was rarely used, which is why\nXen was able to use it to implement paravirtualisation, Xen's novel\napproach to virtualization.  In AMD64, Xen had to use a different\nimplementation approach, so Xen does not use ring 1 to support 64-bit\nguests.  With the focus now being on 64-bit systems, and the availability\nof explicit hardware support for virtualization, fixing speculation issues\nin ring 1 is not a priority for processor companies.\n\nIndirect Branch Restricted Speculation (IBRS) is an architectural x86\nextension put together to combat speculative execution sidechannel attacks,\nincluding Spectre v2.  It was retrofitted in microcode to existing CPUs.\n\nFor more details on Spectre v2, see:\n  http://xenbits.xen.org/xsa/advisory-254.html\n\nHowever, IBRS does not architecturally protect ring 0 from predictions\nlearnt in ring 1.\n\nFor more details, see:\n  https://software.intel.com/security-software-guidance/deep-dives/deep-dive-indirect-branch-restricted-speculation\n\nSimilar situations may exist with other mitigations for other kinds of\nspeculative execution attacks.  The situation is quite likely to be similar\nfor speculative execution attacks which have yet to be discovered,\ndisclosed, or mitigated.\n\n\nSystems running all versions of Xen are affected.\n\nOnly x86 systems are vulnerable, and only CPUs which are potentially\nvulnerable to Spectre v2.  Consult your hardware manufacturer.\n\nThe vulnerability can only be exploited by 32-bit PV guests which are not\nrun in PV-Shim.\n\n\nBARE 32 BIT PV SECURITY SUPPORT STATUS\n======================================\n\nThis advisory discloses only a (very serious) information disclosure\nvulnerability exploitable by bare 32 bit PV guests, using speculative\nexecution.\n\nWe are considering further entirely withdrawing security support for\nconfigurations with non-shim 32 bit PV guests.  Any such decision,\nincluding the precise scope of the (de)support, will be made following\npublic community discussion.\n\nThe result of that public process will be a patch to the security support\nstatement, backported (as applicable) to the relevant trees."
         }
      ]
   },
   "impact" : {
      "impact_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "A malicious 32-bit guest kernel may be able to mount a Spectre v2 attack\nagainst Xen, despite the presence hardware protections being active.\n\nIt therefore might be able to infer the contents of arbitrary host memory,\nincluding memory assigned to other guests."
               }
            ]
         }
      }
   },
   "problemtype" : {
      "problemtype_data" : [
         {
            "description" : [
               {
                  "lang" : "eng",
                  "value" : "unknown"
               }
            ]
         }
      ]
   },
   "references" : {
      "reference_data" : [
         {
            "url" : "https://xenbits.xenproject.org/xsa/advisory-370.txt"
         }
      ]
   },
   "workaround" : {
      "workaround_data" : {
         "description" : {
            "description_data" : [
               {
                  "lang" : "eng",
                  "value" : "Running 32-bit PV guests under PV-Shim avoids the vulnerability when Spectre v2\nprotections are otherwise enabled on the system.\n\nPV shim is available and fully security-supported in all\nsecurity-supported versions of Xen.  Using shim is the recommended\nconfiguration.\n\nNot running 32-bit PV guests avoids the vulnerability."
               }
            ]
         }
      }
   }
}
